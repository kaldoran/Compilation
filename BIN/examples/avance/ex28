% VIDEO GAME %

var MAX_Y : int;
var MAX_X : int;
						-- DEBUT DE LA MAP --
type coordonnee : 
	struct 
		x : float;
		y : float;
		z : int;
	end struct;

type map : array [0..100] of coordonnee;

						--     MUNITION      --
type munition :
	struct 
		balle : int;
		grenade : int;
	end struct;
		
type Player : 
	struct 
		nom : string[200];
		score : int;
		position : coordonnee;
		munition : munition;
	end struct;

function positionPlayerX (P : Player) return float 
    var posX : float;
    start { 
	    if ((posX = P.position.x) > 0) then {
	    	return posX;
	    }
	    return -1;		
    };



function positionPlayerY (p : Player) return float
var posY : float;
start {
	if ((posY = p.position.y) > 0) then {
		return posY;
	}
	return -1;	
	
};

function nbMunition(p : Player) return int 
    start { 
        return p.munition.balle; 
    };

var map : map;

proc item (coord : coordonnee)
    var i : int;

    start {
        for i=0; ( i < MAX_X and i < MAX_Y); i++ do {
            if (coord.x.map[i] != 7.8 and coord.y.map[i] < "chaine magique") then {
                write("Vous regardez la chaine magique !", coord.x.map[(10 % 5)]);
            }
            else if( (i = (i * 5 % 3)) != 87548 ) then { 
                write("Un diamant ! Il se mange ?");
            }
            else {
                write("Vous trouvez %d petit(s) caillou(x)\n",rand());
            }
        }
    };

proc affiche(P : Player ) 
    start {
        write("Nb munition", nbMunition(P));
        return;
    };

proc affichePos(P : Player) 
    start {
        write("Position actuelle : %d %d", positionPlayerX(P), positionPlayerY(P));
        return;
    };

function move(P : Player,  x : float , y : float ) return int 
	proc Love(P : Player ) 
		proc ProcCeption(P : Player ) 
			function lol() return int
			start {
				return;
			};
		start {
			write("Imbrication");
			return;
		};
	start {
		write("I love you");
		return;
	};
start {
	P.position.x = x;
	P.position.y = y;
	affichePos(P);
	return 1;
};

var newplayer : Player;
var jump : int;
var was_it_true : bool;
var var_map : map;

start { 
	map[10].x = 10; /* Le compilo ne bronche pas, alors que map est un type */
	newplayer.nom = "Kaldoran";
	if ( (jump = (newplayer.position.z)) > 0) then {
		write("jump height : %d",jump);
		;
	}
	else if(map[newplayer.position.x + newplayer.munition + jump % MAX_Y]) then {
		jump = 0;
		newplayer.position.x = 0;
		newplayer.position.y = 0;
		newplayer.position.z = 0;
		newplayer.score = -1;
		newplayer.nom = "Cheateur";
		write("Cheat detected !");
		read(was_it_true);
		was_it_true = (was_it_true == false) ? "Menteur" : "Meuteur quand mÃªme";
		write("%s",was_it_true);
	}

	; // ca sert a rien mais c'est cool
} 
-- FIN PROGRAMME --



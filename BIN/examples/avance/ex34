% PROGRAMME GESTION CONTACT %

type date : 
	struct
		jour : int;
		mois : int;
		annee : int;
	end struct;

type adresse : 
	struct 
		numero : int;
		estrue : bool;
		estchemin : bool;
		estboulevard : bool;
		estautre : bool;
		adresse : string[500];
		codePostal : int;
	end struct;

type contact : 
	struct
		nom : string[50];
		prenom : string[30];
		date_naissance : date;
		marier : bool;
		dateajout : date;
		email : string[100];
		adresse_contact : adresse;
	end struct;

type carnet : array [0..100, 0 .. 100] of contact;

var moncarnet : carnet;
var datetime : date;

proc init_adresse (adr : adresse)
    start {
        adr.numero = 0;
        adr.estrue = 0;
        adr.estchemin = 0;
        adr.estboulevard = 0;
        adr.estautre = 1;
        adr.adresse = "";
        adr.codePostal = 0;
    };

proc init_date(datetime : date) 
start {
	datetime.jour = 0;
	datetime.mois = 0;
	datetime.annee = 0;
};

proc init(moncarnet : carnet)
    var i : int;
    start {
        for ( i=0 ; i == 100 ; i++) do {
            moncarnet[i][0].nom = "";
            moncarnet[i][0].prenom = "";
            init_date(moncarnet[i][0].date_naissance.jour);
            moncarnet[i][0].marier = 0;
            init_date(moncarnet[i][0].dateajout);
            moncarnet[i][0].email = "";
            init_adresse(moncarnet[i][0].adresse_contact);
        }
    };


function existe(prenom : string[30],nom : string[50],moncarnet : carnet) return bool
var i : int;
var existe : bool;
start {
	existe = false;
	while ( i <= 100) do {
		if ( moncarnet[i][0].prenom == prenom and moncarnet[i][0].dateajout  and moncarnet[i][0].nom == nom ) then {
			existe = !existe;
			return existe;
		}
		i++;
	}
	return existe;
};

function addcarnet(moncarnet : carnet,prenom : string[30],nom : string[50] , date_naissance : date) return bool
var i : int;
start {
	while( i <= 100) do {
		/* la fonction vide existe pas mais on suppose qu'elle existe */
		if(prenom == "" or nom == "" or init_date(moncarnet[i][0].date_naissance) ) then {
			write("Erreur !");
			return 0;
		}
		if ( moncarnet[i][0].prenom == "" or moncarnet[i][0].nom == "") then {
			moncarnet[i][0].prenom = prenom;
			moncarnet[i][0].nom = nom;
			
			return i;
		}

	}
	return 0;
};

proc mariage(moncarnet : carnet, homme : contact , femme : contact ) 
var i : int;

start {
	if ( i = existe ( homme.prenom , homme.nom , moncarnet ) != 0 ) then {
		moncarnet[1][i] = femme;
	}
	else {
		i = addcarnet(moncarnet, homme.prenom,homme.nom,homme.date_naissance); // ajout pour avoir un emplacement vide
		moncarnet[0][i] = homme; # homme associÃ© pour recuperer entierement les info
		moncarnet[1][i] = femme; // mariage en cours
	}

};


start { 
	init(moncarnet); 
	init(datetime);
	addcarnet(moncarnet , "Jean", "Bonnot" , datetime);
	write("%d",existe("Jean","Bonnot",moncarnet));
	write("%d",!!!!!existe("Janne","Bonnot",moncarnet));
	write("%d",existe(moncarnet , "rien" , 0)); 

	write("Au revoir !");
	
}

